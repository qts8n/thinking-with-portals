[gd_scene load_steps=9 format=3 uid="uid://dd3iysk3m46cu"]

[ext_resource type="ArrayMesh" uid="uid://bx53fj6jgha6k" path="res://assets/portal.obj" id="1_qg7o8"]
[ext_resource type="Script" path="res://src/portal.gd" id="1_tp3cd"]
[ext_resource type="Shader" path="res://src/shaders/portal.gdshader" id="2_tw0le"]

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_0lt6w"]
data = PackedVector3Array(2.6123, 3.155, 0.0083, 2.6123, 3.1206, -0.1553, 2.6123, 3.1206, 0.0083, -2.6335, 3.1206, 0.0083, -2.6335, 3.155, -0.1553, -2.6335, 3.155, 0.0083, 2.6123, 3.155, 0.0083, -2.6335, 3.155, -0.1553, 2.6123, 3.155, -0.1553, -2.6335, 3.1206, 0.0083, -2.519, 3.1011, -0.1517, -2.6335, 3.1206, -0.1553, -2.519, 3.1011, -0.1517, -2.6335, 3.1206, 0.0083, -2.519, 3.1011, 0.0083, 2.6123, 3.155, -0.1553, -2.6335, 3.1206, -0.1553, 2.6123, 3.1206, -0.1553, -2.6335, 3.1206, -0.1553, 2.6123, 3.155, -0.1553, -2.6335, 3.155, -0.1553, 2.4977, 3.1011, -0.1517, -2.519, 3.0765, -0.1517, 2.4977, 3.0765, -0.1517, -2.519, 3.0765, -0.1517, 2.4977, 3.1011, -0.1517, -2.519, 3.1011, -0.1517, 2.4977, 3.1011, 0.0083, 2.4977, 3.0765, -0.1517, 2.4977, 3.0765, 0.0083, 2.4977, 3.1011, -0.1517, -2.6335, 3.1206, -0.1553, -2.519, 3.1011, -0.1517, -2.6335, 3.1206, -0.1553, 2.4977, 3.1011, -0.1517, 2.6123, 3.1206, -0.1553, 2.4977, 3.0765, -0.1517, -2.2819, 3.0496, -0.1477, 2.2606, 3.0496, -0.1477, -2.2819, 3.0496, -0.1477, 2.4977, 3.0765, -0.1517, -2.519, 3.0765, -0.1517, -2.519, 3.0765, 0.0083, -2.519, 3.1011, -0.1517, -2.519, 3.1011, 0.0083, -2.0082, 0.9686, -0.1477, -2.2819, 0.0152, -0.1477, -2.0082, 0.0152, -0.1477, 1.9869, 0.9686, -0.1477, 2.2606, 0.0152, -0.1477, 2.2606, 0.9686, -0.1477, 2.2606, 0.0152, -0.1477, 1.9869, 0.9686, -0.1477, 1.9869, 0.0152, -0.1477, 2.2606, 0.9686, -0.1477, 1.9869, 2.9932, -0.1477, 1.9869, 0.9686, -0.1477, 2.2606, 0.9686, -0.1477, 2.2606, 3.0496, -0.1477, 1.9869, 2.9932, -0.1477, 2.2606, 3.0496, -0.1477, -2.0082, 2.9932, -0.1477, 1.9869, 2.9932, -0.1477, 2.2606, 3.0496, -0.1477, -2.2819, 3.0496, -0.1477, -2.0082, 2.9932, -0.1477, -2.2819, 0.0152, -0.1477, -2.0082, 0.9686, -0.1477, -2.2819, 0.9686, -0.1477, -2.0082, 2.9932, -0.1477, -2.2819, 0.9686, -0.1477, -2.0082, 0.9686, -0.1477, -2.2819, 0.9686, -0.1477, -2.0082, 2.9932, -0.1477, -2.2819, 3.0496, -0.1477, -2.0082, 0.0152, 0.0083, -2.2819, 0.0152, -0.1477, -2.2819, 0.0152, 0.0083, -2.519, 3.0765, 0.0083, -2.2819, 3.0496, -0.1477, -2.519, 3.0765, -0.1517, -2.2819, 3.0496, -0.1477, -2.519, 3.0765, 0.0083, -2.2819, 3.0496, 0.0083, 2.2606, 0.0152, 0.0083, 2.2606, 0.9686, -0.1477, 2.2606, 0.0152, -0.1477, 2.2606, 0.9686, 0.0083, 2.2606, 3.0496, -0.1477, 2.2606, 0.9686, -0.1477, -2.2819, 0.0152, -0.1477, -2.2819, 0.9686, -0.1477, -2.2819, 0.0152, 0.0083, -2.2819, 0.9686, -0.1477, -2.2819, 3.0496, -0.1477, -2.2819, 0.9686, 0.0083, -2.0082, 0.0152, 0.0083, -2.0082, 0.9686, -0.1477, -2.0082, 0.0152, -0.1477, 1.9869, 0.0152, 0.0083, 1.9869, 0.9686, -0.1477, 1.9869, 0.9686, 0.0083, 1.9869, 0.9686, 0.0083, 1.9869, 2.9932, -0.1477, 1.9869, 2.9932, 0.0083, -2.0082, 0.9686, 0.0083, -2.0082, 2.9932, -0.1477, -2.0082, 0.9686, -0.1477, -2.0082, 0.9686, 0.0083, -2.0082, 2.9932, 0.0083, -2.0082, 2.9932, -0.1477, 2.6123, 3.155, 0.1719, 2.6123, 3.155, 0.0083, 2.6123, 3.1206, 0.1719, 2.6123, 3.1206, -0.1553, 2.6123, 3.155, 0.0083, 2.6123, 3.155, -0.1553, 2.6123, 3.1206, 0.1719, 2.6123, 3.155, 0.0083, 2.6123, 3.1206, 0.0083, -2.6335, 3.155, -0.1553, -2.6335, 3.1206, 0.0083, -2.6335, 3.1206, -0.1553, -2.6335, 3.1206, 0.0083, -2.6335, 3.155, 0.1719, -2.6335, 3.1206, 0.1719, -2.6335, 3.155, 0.0083, -2.6335, 3.155, 0.1719, -2.6335, 3.1206, 0.0083, -2.6335, 3.155, -0.1553, 2.6123, 3.155, 0.0083, -2.6335, 3.155, 0.0083, -2.6335, 3.155, 0.1719, 2.6123, 3.155, 0.0083, 2.6123, 3.155, 0.1719, -2.6335, 3.155, 0.0083, 2.6123, 3.155, 0.0083, -2.6335, 3.155, 0.1719, 2.4977, 3.1011, -0.1517, 2.4977, 3.1011, 0.0083, 2.6123, 3.1206, 0.0083, 2.4977, 3.1011, 0.0083, 2.4977, 3.1011, 0.1682, 2.6123, 3.1206, 0.0083, 2.6123, 3.1206, 0.1719, 2.6123, 3.1206, 0.0083, 2.4977, 3.1011, 0.1682, 2.4977, 3.1011, -0.1517, 2.6123, 3.1206, 0.0083, 2.6123, 3.1206, -0.1553, -2.519, 3.1011, 0.1682, -2.6335, 3.1206, 0.0083, -2.6335, 3.1206, 0.1719, -2.6335, 3.1206, 0.0083, -2.519, 3.1011, 0.1682, -2.519, 3.1011, 0.0083, -2.6335, 3.1206, 0.1719, 2.6123, 3.155, 0.1719, 2.6123, 3.1206, 0.1719, -2.6335, 3.155, 0.1719, 2.6123, 3.155, 0.1719, -2.6335, 3.1206, 0.1719, -2.519, 3.0765, 0.1682, 2.4977, 3.1011, 0.1682, 2.4977, 3.0765, 0.1682, -2.519, 3.1011, 0.1682, 2.4977, 3.1011, 0.1682, -2.519, 3.0765, 0.1682, 2.4977, 3.0765, 0.1682, 2.4977, 3.1011, 0.0083, 2.4977, 3.0765, 0.0083, 2.4977, 3.1011, 0.1682, 2.4977, 3.1011, 0.0083, 2.4977, 3.0765, 0.1682, 2.4977, 3.0765, -0.1517, 2.4977, 3.1011, 0.0083, 2.4977, 3.1011, -0.1517, -2.6335, 3.1206, 0.1719, 2.4977, 3.1011, 0.1682, -2.519, 3.1011, 0.1682, 2.4977, 3.1011, 0.1682, -2.6335, 3.1206, 0.1719, 2.6123, 3.1206, 0.1719, 2.2606, 3.0496, -0.1477, 2.2606, 3.0496, 0.0083, 2.4977, 3.0765, 0.0083, 2.2606, 3.0496, 0.0083, 2.2606, 3.0496, 0.1642, 2.4977, 3.0765, 0.0083, 2.4977, 3.0765, 0.1682, 2.4977, 3.0765, 0.0083, 2.2606, 3.0496, 0.1642, 2.2606, 3.0496, -0.1477, 2.4977, 3.0765, 0.0083, 2.4977, 3.0765, -0.1517, -2.2819, 3.0496, 0.1642, 2.4977, 3.0765, 0.1682, 2.2606, 3.0496, 0.1642, 2.4977, 3.0765, 0.1682, -2.2819, 3.0496, 0.1642, -2.519, 3.0765, 0.1682, -2.519, 3.1011, -0.1517, -2.519, 3.0765, 0.0083, -2.519, 3.0765, -0.1517, -2.519, 3.0765, 0.0083, -2.519, 3.1011, 0.1682, -2.519, 3.0765, 0.1682, -2.519, 3.1011, 0.0083, -2.519, 3.1011, 0.1682, -2.519, 3.0765, 0.0083, -2.0082, 0.9686, 0.1642, -2.2819, 0.0152, 0.1642, -2.2819, 0.9686, 0.1642, 2.2606, 0.9686, 0.1642, 2.2606, 0.0152, 0.1642, 1.9869, 0.9686, 0.1642, 1.9869, 0.0152, 0.1642, 1.9869, 0.9686, 0.1642, 2.2606, 0.0152, 0.1642, 1.9869, 0.9686, 0.1642, 1.9869, 2.9932, 0.1642, 2.2606, 0.9686, 0.1642, 2.2606, 3.0496, 0.1642, 2.2606, 0.9686, 0.1642, 1.9869, 2.9932, 0.1642, -2.0082, 2.9932, 0.1642, 2.2606, 3.0496, 0.1642, 1.9869, 2.9932, 0.1642, -2.2819, 3.0496, 0.1642, 2.2606, 3.0496, 0.1642, -2.0082, 2.9932, 0.1642, -2.2819, 0.0152, 0.1642, -2.0082, 0.9686, 0.1642, -2.0082, 0.0152, 0.1642, -2.0082, 2.9932, 0.1642, -2.2819, 0.9686, 0.1642, -2.2819, 3.0496, 0.1642, -2.2819, 0.9686, 0.1642, -2.0082, 2.9932, 0.1642, -2.0082, 0.9686, 0.1642, 1.9869, 0.0152, 0.0083, 2.2606, 0.0152, 0.0083, 1.9869, 0.0152, -0.1477, 1.9869, 0.0152, -0.1477, 2.2606, 0.0152, 0.0083, 2.2606, 0.0152, -0.1477, 1.9869, 0.0152, 0.0083, 1.9869, 0.0152, 0.1642, 2.2606, 0.0152, 0.0083, 1.9869, 0.0152, 0.1642, 2.2606, 0.0152, 0.1642, 2.2606, 0.0152, 0.0083, -2.2819, 0.0152, -0.1477, -2.0082, 0.0152, 0.0083, -2.0082, 0.0152, -0.1477, -2.2819, 0.0152, 0.1642, -2.0082, 0.0152, 0.0083, -2.2819, 0.0152, 0.0083, -2.0082, 0.0152, 0.0083, -2.2819, 0.0152, 0.1642, -2.0082, 0.0152, 0.1642, -2.2819, 0.0152, 0.0083, -2.2819, 0.9686, 0.1642, -2.2819, 0.0152, 0.1642, -2.2819, 0.9686, 0.0083, -2.2819, 0.0152, 0.0083, -2.2819, 0.9686, -0.1477, -2.2819, 0.0152, 0.0083, -2.2819, 0.9686, 0.0083, -2.2819, 0.9686, 0.1642, -2.2819, 3.0496, 0.0083, -2.2819, 0.9686, 0.0083, -2.2819, 3.0496, -0.1477, -2.2819, 3.0496, 0.1642, -2.519, 3.0765, 0.0083, -2.519, 3.0765, 0.1682, -2.519, 3.0765, 0.0083, -2.2819, 3.0496, 0.1642, -2.2819, 3.0496, 0.0083, 2.2606, 0.9686, 0.1642, 2.2606, 0.0152, 0.0083, 2.2606, 0.0152, 0.1642, 2.2606, 0.0152, 0.0083, 2.2606, 0.9686, 0.1642, 2.2606, 0.9686, 0.0083, 2.2606, 0.9686, 0.0083, 2.2606, 3.0496, 0.0083, 2.2606, 3.0496, -0.1477, 2.2606, 3.0496, 0.1642, 2.2606, 0.9686, 0.0083, 2.2606, 0.9686, 0.1642, 2.2606, 0.0152, 0.0083, 2.2606, 0.9686, 0.0083, 2.2606, 0.9686, -0.1477, 2.2606, 0.9686, 0.0083, 2.2606, 3.0496, 0.1642, 2.2606, 3.0496, 0.0083, -2.2819, 0.9686, 0.0083, -2.2819, 3.0496, 0.1642, -2.2819, 0.9686, 0.1642, -2.2819, 0.9686, 0.0083, -2.2819, 3.0496, 0.0083, -2.2819, 3.0496, 0.1642, -2.0082, 0.9686, 0.0083, -2.0082, 0.0152, 0.0083, -2.0082, 0.9686, 0.1642, -2.0082, 2.9932, -0.1477, 1.9869, 2.9932, 0.0083, 1.9869, 2.9932, -0.1477, -2.0082, 2.9932, 0.0083, 1.9869, 2.9932, 0.0083, -2.0082, 2.9932, -0.1477, -2.0082, 2.9932, 0.1642, 1.9869, 2.9932, 0.0083, -2.0082, 2.9932, 0.0083, 1.9869, 2.9932, 0.0083, -2.0082, 2.9932, 0.1642, 1.9869, 2.9932, 0.1642, 1.9869, 0.9686, -0.1477, 1.9869, 0.0152, 0.0083, 1.9869, 0.0152, -0.1477, 1.9869, 0.0152, 0.0083, 1.9869, 0.9686, 0.1642, 1.9869, 0.0152, 0.1642, 1.9869, 0.9686, 0.0083, 1.9869, 2.9932, 0.1642, 1.9869, 0.9686, 0.1642, 1.9869, 0.0152, 0.0083, 1.9869, 0.9686, 0.0083, 1.9869, 0.9686, 0.1642, 1.9869, 2.9932, -0.1477, 1.9869, 0.9686, 0.0083, 1.9869, 0.9686, -0.1477, 1.9869, 0.9686, 0.0083, 1.9869, 2.9932, 0.0083, 1.9869, 2.9932, 0.1642, -2.0082, 0.0152, 0.1642, -2.0082, 0.9686, 0.1642, -2.0082, 0.0152, 0.0083, -2.0082, 0.9686, 0.1642, -2.0082, 2.9932, 0.1642, -2.0082, 0.9686, 0.0083, -2.0082, 0.0152, 0.0083, -2.0082, 0.9686, 0.0083, -2.0082, 0.9686, -0.1477, -2.0082, 2.9932, 0.0083, -2.0082, 0.9686, 0.0083, -2.0082, 2.9932, 0.1642)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_3jxek"]
albedo_color = Color(1, 0, 1, 1)

[sub_resource type="SphereMesh" id="SphereMesh_nd43p"]
material = SubResource("StandardMaterial3D_3jxek")
radial_segments = 16
rings = 8

[sub_resource type="ViewportTexture" id="ViewportTexture_mqc28"]
viewport_path = NodePath("viewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_uo58c"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("2_tw0le")
shader_parameter/texture_albedo = SubResource("ViewportTexture_mqc28")

[node name="portal" type="Node3D"]
script = ExtResource("1_tp3cd")

[node name="portal_frame" type="StaticBody3D" parent="."]

[node name="portal_frame_hitbox" type="CollisionShape3D" parent="portal_frame"]
shape = SubResource("ConcavePolygonShape3D_0lt6w")

[node name="portal_frame_mesh" type="MeshInstance3D" parent="portal_frame/portal_frame_hitbox"]
mesh = ExtResource("1_qg7o8")
skeleton = NodePath("../..")

[node name="viewport" type="SubViewport" parent="."]
render_target_update_mode = 3

[node name="portal_camera" type="Camera3D" parent="viewport"]

[node name="debug_mesh" type="MeshInstance3D" parent="viewport/portal_camera"]
mesh = SubResource("SphereMesh_nd43p")

[node name="portal_plane" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)
size = Vector3(4, 3, 0.2)
material = SubResource("ShaderMaterial_uo58c")
